<template>
  <div class="container">
    <!-- ÁôªÂá∫ÊåâÈàï -->
    <div class="logout-container">
      <button @click="handleLogout" class="logout-button">ÁôªÂá∫</button>
    </div>
    
    <!-- Sidebar -->
    <div class="sidebar" v-if="showSidebar">
      <!-- ÂêëÂ∑¶Êî∂Ëµ∑ÊåâÈàï -->
      <button class="collapse-button" @click="showSidebar = false">‚óÅ</button>

      <!-- Sidebar Header -->
      <div class="sidebar-header header-with-button">
        <h1 class="sidebar-title">{{ userName }} ÁöÑ‰ªªÂãôÊ∏ÖÂñÆ</h1>
        <button class="mode-toggle-button" @click="toUserPage">Á≠ÜË®ò</button>
      </div>

      <!-- Folder & Note List -->
      <div class="task-list">
        <button 
          v-for="task in tasks" 
          :key="task.id" 
          @click="handleTaskClick(task._id)" 
          class="task-title clickable">
          {{ task.name }}
        </button>
        <button @click="addTask" class="task-title clickable">+ Êñ∞Â¢û</button>
      </div>
    </div>

    <!-- Mini SidebarÔºàÊî∂Ëµ∑ÁãÄÊÖãÔºâ -->
    <div class="mini-sidebar" v-else>
      <button class="expand-button" @click="showSidebar = true">‚ñ∑</button>
    </div>

    <!-- Main Content (Right) -->
    <div class="main-content">
      <!-- Ê†πÊìö FolderId È°ØÁ§∫Áõ∏ÊáâÁöÑË≥áÊñôÂ§æÂÖßÂÆπ -->
      <div class="split-container">
        <div v-if="currentTask" class="task-container" :style="taskContainerStyle">
          <div class="header-with-button">
            <input
              v-model="currentTask.name"
              @blur="updateTaskName"
              class="task-title-input"
            />
            <button class="delete-button" @click="deleteTask">
              Âà™Èô§
            </button>
          </div>

          <!-- ÁØ©ÈÅ∏ÊåâÈàïÂàó -->
          <div class="filter-bar">
            <span class="filter-label">ÁØ©ÈÅ∏Ê¢ù‰ª∂:</span>
            <button
              class="filter-button"
              :class="{ active: filters.name }"
              @click="showNameFilter = true"
            >
              ÂêçÁ®±
            </button>
            <button
              class="filter-button"
              :class="{ active: filters.states.length > 0 }"
              @click="showStateFilter = true"
            >
              ÁãÄÊÖã
            </button>
            <button
              class="filter-button"
              :class="{ active: filters.startDate || filters.endDate }"
              @click="showDateFilter = true"
            >
              Êó•Êúü
            </button>
          </div>

          <!-- ÂêçÁ®±Ë®≠ÂÆöË¶ñÁ™ó -->
          <div v-if="showNameFilter" class="modal-overlay" @click.self="showNameFilter = false">
            <div class="modal-content">
              <h3 class="modal-title">Ëº∏ÂÖ•ÂêçÁ®±ÈóúÈçµÂ≠ó</h3>
              <input v-model="filters.name" @input="applyFilters" class="modal-input" />
              <div class="modal-buttons">
                <button @click="showNameFilter = false; filters.name = ''; applyFilters();" class="modal-cancel">ÂèñÊ∂à</button>
                <button @click="showNameFilter = false; applyFilters()" class="modal-confirm">Á¢∫ÂÆö</button>
              </div>
            </div>
          </div>

          <!-- ÁãÄÊÖãË®≠ÂÆöË¶ñÁ™ó -->
          <div v-if="showStateFilter" class="modal-overlay" @click.self="showStateFilter = false">
            <div class="modal-content">
              <h3 class="modal-title">ÈÅ∏ÊìáÁãÄÊÖã</h3>
              <div class="status-options">
                <label v-for="status in statusOptions" :key="status">
                  <input
                    type="checkbox"
                    :value="status"
                    v-model="filters.states"
                    @change="applyFilters"
                  />
                  {{ status }}
                </label>
              </div>
              <div class="modal-buttons">
                <button @click="showStateFilter = false; filters.states = []; applyFilters();" class="modal-cancel">ÂèñÊ∂à</button>
                <button @click="showStateFilter = false; applyFilters()" class="modal-confirm">Á¢∫ÂÆö</button>
              </div>
            </div>
          </div>

          <!-- Êó•ÊúüË®≠ÂÆöË¶ñÁ™ó -->
          <div v-if="showDateFilter" class="modal-overlay" @click.self="showDateFilter = false">
            <div class="modal-content">
              <h3 class="modal-title">ÈÅ∏ÊìáÊó•ÊúüÁØÑÂúç</h3>
              <input type="date" v-model="filters.startDate" class="modal-input" />
              <span>ÔΩû</span>
              <input type="date" v-model="filters.endDate" class="modal-input" />
              <div class="modal-buttons">
                <button @click="showDateFilter = false; filters.startDate = ''; filters.endDate = ''; applyFilters();" class="modal-cancel">ÂèñÊ∂à</button>
                <button @click="applyFilters(); showDateFilter = false" class="modal-confirm">Á¢∫ÂÆö</button>
              </div>
            </div>
          </div>

          <!-- Add scrollable container for the table -->
          <div class="scrollable-table-container">
            <table class="task-table">
              <thead>
                <tr>
                  <th></th>
                  <th @click="sortBy('name')">
                    ÂêçÁ®±
                    <span v-if="sortByField === 'name'">
                      <i v-if="sortOrder === 'asc'" class="triangle up"></i>
                      <i v-else class="triangle down"></i>
                    </span>
                  </th>
                  <th>Ë™™Êòé</th>
                  <th @click="sortBy('state')">
                    ÁãÄÊÖã
                    <span v-if="sortByField === 'state'">
                      <i v-if="sortOrder === 'asc'" class="triangle up"></i>
                      <i v-else class="triangle down"></i>
                    </span>
                  </th>
                  <th @click="sortBy('time')">
                    Êó•Êúü
                    <span v-if="sortByField === 'time'">
                      <i v-if="sortOrder === 'asc'" class="triangle up"></i>
                      <i v-else class="triangle down"></i>
                    </span>
                  </th>
                  <th>Á≠ÜË®ò</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr v-for="item in showTaskItem" :key="item._id" class="task-row">
                  <td>
                    <!-- Button to open the modal -->
                    <button @click="showTaskListModal(item)" class="move-icon text-white text-xl bg-transparent border-none p-0">
                      ...
                    </button>

                    <!-- Modal: show task.name list as buttons -->
                    <div v-show="showingTaskListForId === item._id" class="modal-overlay">
                      <div class="note-modal">
                        <div class="modal-body">
                            <p class="linkable-notes-title">ÁßªÂãïÂà∞</p>
                            <div  v-for="task in tasks" :key="task.id">
                              <button @click="moveToTask(task._id)" class="note-button">
                                {{ task.name }}  <!-- È°ØÁ§∫Á≠ÜË®òÊ®ôÈ°åÔºåÊ†πÊìö‰Ω†ÁöÑË≥áÊñôÁµêÊßãË™øÊï¥ -->
                              </button>
                            </div>
                        </div>
                        <button @click="closeTaskModal" class="modal-cancel-button">close</button>
                      </div>
                    </div>
                  </td>
                  
                  <td><input v-model="item.name" @blur="updateItem(item)" /></td>

                  <td>
                    <!-- Button to open the modal -->
                    <button @click="EditContent(item)" class="content-icon">
                      üóíÔ∏è
                    </button>

                    <!-- Modal that appears when editingItemId matches the item's ID -->
                    <div v-show="editingItemId === item._id" id="editModal" :class="{ open: editingItemId === item._id }">
                      <div class="edit-modal-content">
                        <!-- Bind textarea to editingContent instead of item.content -->
                        <textarea v-model="editingContent" rows="4" cols="50"></textarea>
                        <button @click="saveChanges(item)" class="modal-save-button">Save</button>
                        <button @click="closeModal()" class="modal-cancel-button">Cancel</button>
                      </div>
                    </div>
                  </td>

                  <td>
                    <select v-model="item.state" @change="updateItem(item)">
                      <option value="Êú™ÈñãÂßã">Êú™ÈñãÂßã</option>
                      <option value="ÈÄ≤Ë°å‰∏≠">ÈÄ≤Ë°å‰∏≠</option>
                      <option value="ÂÆåÊàê">ÂÆåÊàê</option>
                    </select>
                  </td>

                  <td>
                    <input
                      type="datetime-local"
                      :value="formatDateTimeForInput(item.time)"
                      @change="e => { item.time = e.target.value; updateItem(item); }"
                    />
                  </td>

                  <td>
                    <!-- Button to open the modal -->
                    <button @click="NoteContent(item._id)" class="content-icon">
                      üìí
                    </button>

                    <!-- Modal overlay -->
                    <div v-if="showNoteContent" class="modal-overlay">
                      <div class="note-modal">
                        <div v-if="showUserNotes" class="modal-body">
                          <p class="linkable-notes-title">ÂèØÈÄ£ÁµêÁ≠ÜË®ò</p>
                          <div v-for="note in showUserNotes" :key="note._id">
                            <button @click="connectNote(currentItemId, note._id)" class="note-button">
                              {{ note.name }}  <!-- È°ØÁ§∫Á≠ÜË®òÊ®ôÈ°åÔºåÊ†πÊìö‰Ω†ÁöÑË≥áÊñôÁµêÊßãË™øÊï¥ -->
                            </button>
                          </div>
                        </div>
                        <div v-else class="modal-body">
                            <p class="linkable-notes-title">Â∑≤ÈÄ£ÁµêÁ≠ÜË®ò</p>
                            <div v-for="note in taskNotes" :key="note._id">
                              <!-- Ê†πÊìöÁ≠ÜË®òÂÖßÂÆπÁîüÊàêÊåâÈàï -->
                              <button @click="fetchNote(note.note)" class="note-button">
                                {{ note.noteName }}  <!-- È°ØÁ§∫Á≠ÜË®òÊ®ôÈ°åÔºåÊ†πÊìö‰Ω†ÁöÑË≥áÊñôÁµêÊßãË™øÊï¥ -->
                              </button>
                              <button @click="deleteNoteLink(note.note)" class="delete-button">
                                X
                              </button>
                            </div>
                            <button @click="showUserNoteList" class="add-note-button">+Êñ∞Â¢û</button>
                        </div>
                        <button @click="closeModal" class="modal-cancel-button">Close</button>
                      </div>
                    </div>
                  </td>

                  <td class="delete-cell">
                    <button @click="deleteItem(item._id)" class="delete-icon">
                      Âà™Èô§
                    </button>
                  </td>

                </tr>
              </tbody>
            </table>
          </div>

          <button @click="addItem" class="task-title clickable">+ Êñ∞Â¢ûÈ†ÖÁõÆ</button>
        </div>

        <div v-show="noteContent !== null" class="note-content-block" :style="noteContentStyle">
          <button class="close-note-btn" @click="resetNoteContemt">
            ‚ùå
          </button>
          <div class="note-header">
            <h1>Á≠ÜË®ò: {{ noteName }}</h1>
            <button class="edit-note-btn" @click="editNote">
              ‚úèÔ∏è Á∑®ËºØ
            </button>
          </div>
          <hr>
          <div id="markdown-output" v-html="noteContent"></div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios';
import { marked } from 'marked';
import hljs from 'highlight.js';

export default {
  data() {
    return {
      tasks: [],
      currentTask: null,
      filters: {
        name: '',
        states: [],
        startDate: '',
        endDate: ''
      },
      statusOptions: ['Êú™ÈñãÂßã', 'ÈÄ≤Ë°å‰∏≠', 'ÂÆåÊàê'],
      showNameFilter: false,
      showStateFilter: false,
      showDateFilter: false,
      showTaskItem: null,
      sortByField: 'name',
      sortOrder: 'asc', // 'asc' Ë°®Á§∫ÂçáÂ∫èÔºå'desc' Ë°®Á§∫ÈôçÂ∫è
      editingItemId: null,
      editingContent: '',
      userName: localStorage.getItem('userName') || 'Êú™Áü•Áî®Êà∂',
      showNoteContent: false,
      showUserNotes: null,
      taskNotes: null,
      currentItemId: null,
      noteContent: null,
      noteName: null,
      noteId: null,
      showSidebar: true,
      showingTaskListForId: null,
    };
  },
  computed: {
    filteredItems() {
      return this.currentTask.items.filter(item => {
        const matchName = item.name.includes(this.filters.name);
        const matchState =
          this.filters.states.length === 0 || this.filters.states.includes(item.state);
        const itemDate = new Date(item.time);
        const matchDate =
          (!this.filters.startDate || itemDate >= new Date(this.filters.startDate)) &&
          (!this.filters.endDate || itemDate <= new Date(this.filters.endDate));
        return matchName && matchState && matchDate;
      });
    },
    taskContainerStyle() {
      return {
        width: this.noteContent !== null ? '48%' : '100%', // Áï∂ noteContent ‰∏çÁÇ∫ null ÊôÇÔºåtask-container Âç† 48% ÂØ¨Â∫¶
        transition: 'width 0.3s'
      };
    },
    noteContentStyle() {
      return {
        width: this.noteContent !== null ? '48%' : '0', // Áï∂ noteContent ‰∏çÁÇ∫ null ÊôÇÔºånote-content-block Âç† 48% ÂØ¨Â∫¶ÔºåÂê¶ÂâáÂØ¨Â∫¶ÁÇ∫0
        display: this.noteContent !== null ? 'block' : 'none', // Ê†πÊìö noteContent ÊòØÂê¶ÊúâÂÄº‰æÜÊéßÂà∂È°ØÁ§∫ËàáÂê¶
        transition: 'width 0.3s, opacity 0.3s'
      };
    },
  },
  methods: {
    async addTask() {
        const userId = localStorage.getItem('userId');
        try {
            const response = await axios.post('/api/createTask', {
            userId,
            });

            const newTask = response.data.task;
            await this.fetchUserTasks();
            console.log('Êñ∞‰ªªÂãôÂª∫Á´ãÊàêÂäü:', newTask);
        } catch (error) {
            console.error('Âª∫Á´ã‰ªªÂãôÂ§±Êïó:', error);
            alert('ÁÑ°Ê≥ïÂª∫Á´ã‰ªªÂãô');
        }
    },
    async fetchUserTasks() {
      this.tasks = []
      try {
        const userId = localStorage.getItem('userId');
        const response = await axios.post('/api/getUserTasks', { userId });
        this.tasks = response.data.tasks;
        console.log(this.tasks)
      } catch (error) {
        console.error('ÂèñÂæó‰ªªÂãôÂ§±ÊïóÔºö', error);
        alert('ÁÑ°Ê≥ïÂèñÂæó‰ªªÂãô');
      }
    },
    handleTaskClick(TaskId){
      localStorage.setItem('TaskId', TaskId);
      const targetTask = this.tasks.find(task => task._id === TaskId);
      this.currentTask = targetTask
      this.applyFilters();
      this.resetNoteContemt();
    },
    formatDateTimeForInput(isoString) {
      if (!isoString) return '';
      const date = new Date(isoString);
      const pad = n => String(n).padStart(2, '0');
      const yyyy = date.getFullYear();
      const mm = pad(date.getMonth() + 1);
      const dd = pad(date.getDate());
      const hh = pad(date.getHours());
      const min = pad(date.getMinutes());
      return `${yyyy}-${mm}-${dd}T${hh}:${min}`;
    },
    async addItem(){
      const taskId = localStorage.getItem('TaskId');
      try {
            const response = await axios.post('/api/createTaskItem', {
              taskId,
            });
            const newItem = response.data.item;
            await this.fetchUserTasks();
            this.resetFilters();
            this.handleTaskClick(taskId);
            console.log('Êñ∞È†ÖÁõÆÂª∫Á´ãÊàêÂäü', newItem);
        } catch (error) {
            console.error('Âª∫Á´ãÈ†ÖÁõÆÂ§±Êïó:', error);
            alert('ÁÑ°Ê≥ïÂª∫Á´ãÈ†ÖÁõÆ');
        }
    },
    async updateItem(item) {
     const taskId = localStorage.getItem('TaskId');
      try {
            const response = await axios.post('/api/updateItem', {
              itemId: item._id,
              name: item.name, 
              state: item.state,
              time: item.time,
              content: item.content
            });
            const newItem = response.data.item;
            await this.fetchUserTasks();
            this.handleTaskClick(taskId);
            console.log('Êñ∞È†ÖÁõÆÂª∫Á´ãÊàêÂäü', newItem);
        } catch (error) {
            console.error('Âª∫Á´ãÈ†ÖÁõÆÂ§±Êïó:', error);
            alert('ÁÑ°Ê≥ïÂª∫Á´ãÈ†ÖÁõÆ');
        }
    },
    async updateTaskName(){
      const taskId = localStorage.getItem('TaskId');
      try {
            const response = await axios.post('/api/updateTask', {
              taskId: taskId,
              name: this.currentTask.name, 
            });
            const newTask = response.data.task;
            console.log('Êñ∞È†ÖÁõÆÂª∫Á´ãÊàêÂäü', newTask);
        } catch (error) {
            console.error('Âª∫Á´ãÈ†ÖÁõÆÂ§±Êïó:', error);
            alert('ÁÑ°Ê≥ïÂª∫Á´ãÈ†ÖÁõÆ');
        }
    },
    toUserPage(){
      this.$router.push({ name: 'user' });
    },
    async deleteTask(){
      const confirmed = window.confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄã‰ªªÂãôÂóéÔºü');
      if (confirmed) {
        const taskId = this.currentTask._id;
        try {
            await axios.post('/api/deleteTask', {
              taskId,
            });
            await this.fetchUserTasks();
            this.currentTask = null;
            this.showTaskItem = null;
            localStorage.removeItem('TaskId');
            alert('Âà™Èô§ÊàêÂäü');
        } catch (error) {
            console.error('Âà™Èô§Â§±Êïó:', error);
            alert('ÁÑ°Ê≥ïÂà™Èô§‰ªªÂãô');
        }
      }
    },
    async deleteItem(itemId){
      try {
          await axios.post('/api/deleteItem', {
            itemId,
          });
          await this.fetchUserTasks();
          this.handleTaskClick(this.currentTask._id);
      } catch (error) {
          console.error('Âà™Èô§Â§±Êïó:', error);
          alert('ÁÑ°Ê≥ïÂà™Èô§');
      }
    },
    applyFilters() {
      if (!this.currentTask || !this.currentTask.items) return;

      const nameFilter = this.filters.name?.trim().toLowerCase() || '';
      const selectedStates = this.filters.states || [];
      const startDate = this.filters.startDate ? new Date(this.filters.startDate) : null;
      const endDate = this.filters.endDate ? new Date(this.filters.endDate) : null;

      this.showTaskItem = this.currentTask.items.filter(item => {
        const itemName = item.name || '';
        const itemState = item.state || '';
        const itemTime = item.time ? new Date(item.time) : null;

        const matchesName = !nameFilter || itemName.toLowerCase().includes(nameFilter);
        const matchesState = selectedStates.length === 0 || selectedStates.includes(itemState);
        const matchesDate =
          (!startDate || (itemTime && itemTime >= startDate)) &&
          (!endDate || (itemTime && itemTime <= endDate));

        return matchesName && matchesState && matchesDate;
      });
    },
    resetFilters() {
      this.filters = {
        name: '',
        states: [],
        startDate: '',
        endDate: ''
      };
    },
    sortBy(field) {
      // Â¶ÇÊûúÈªûÊìäÁöÑÊòØÁõ∏ÂêåÁöÑÊ¨Ñ‰ΩçÔºåÂàáÊèõÊéíÂ∫èÈ†ÜÂ∫è
      if (this.sortByField === field) {
        this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';
      } else {
        // Âê¶ÂâáÔºåË®≠ÂÆöÁÇ∫ÂçáÂ∫è
        this.sortByField = field;
        this.sortOrder = 'asc';
      }
      this.sortItems();
    },
    sortItems() {
      if (!this.showTaskItem) return;

      const stateOrder = {
        'ÂÆåÊàê': 0,
        'ÈÄ≤Ë°å‰∏≠': 1,
        'Êú™ÈñãÂßã': 2
      };

      this.showTaskItem.sort((a, b) => {
        let aValue = a[this.sortByField];
        let bValue = b[this.sortByField];

        // ÁâπÂà•ËôïÁêÜÊó•ÊúüËΩâÊèõ
        if (this.sortByField === 'time') {
          aValue = aValue ? new Date(aValue) : null;
          bValue = bValue ? new Date(bValue) : null;
        }

        // ÁâπÂà•ËôïÁêÜÁãÄÊÖãÊéíÂ∫è
        if (this.sortByField === 'state') {
          aValue = aValue in stateOrder ? stateOrder[aValue] : null;
          bValue = bValue in stateOrder ? stateOrder[bValue] : null;
        }

        // null ËôïÁêÜ
        if (aValue === null && bValue === null) return 0;
        if (aValue === null) return this.sortOrder === 'asc' ? -1 : 1;
        if (bValue === null) return this.sortOrder === 'asc' ? 1 : -1;

        // Ê≠£Â∏∏ÊØîËºÉ
        if (this.sortOrder === 'asc') {
          return aValue > bValue ? 1 : aValue < bValue ? -1 : 0;
        } else {
          return aValue < bValue ? 1 : aValue > bValue ? -1 : 0;
        }
      });
    },
    // Open the modal and set the current item as the one being edited
    EditContent(item) {
      this.editingItemId = item._id; // Ë®≠ÂÆöÁ∑®ËºØÈ†ÖÁõÆIDÔºåÈ°ØÁ§∫modal
      if (item) {
        this.editingContent = item.content; // Ë®≠ÂÆöÁ∑®ËºØÂÖßÂÆπ
      }
    },
    // Save the changes when clicking save
    saveChanges(item) {
      item.content = this.editingContent
      this.updateItem(item);
      this.closeModal(); // ÂÑ≤Â≠òÂæåÈóúÈñâmodal
    },
    // Close the modal
    closeModal() {
      this.editingItemId = null; // Reset editingItemId to hide the modal
      this.showNoteContent = false;
      this.showUserNotes = null;
      this.currentItemId = null;
      this.taskNotes = null;
    },
    async NoteContent(itemId) {
      this.currentItemId = itemId;
      try {
          const response = await axios.post('/api/getTaskNotes', {
            itemId : itemId
          });
          this.taskNotes = response.data.taskNotes;
          this.showNoteContent = true;
      } catch (error) {
          console.error('ÂèñÂæóÂ§±Êïó:', error);
          alert('ÁÑ°Ê≥ïÂèñÂæó');
      }
    },
    async connectNote(itemId, noteId){
      try {
          await axios.post('/api/connectTaskNote', {
            itemId,
            noteId
          });
          this.NoteContent(this.currentItemId);
      } catch (error) {
          console.error('ÈÄ£ÁµêÂ§±Êïó:', error);
          alert('ÁÑ°Ê≥ïÈÄ£Áµê');
      }
      this.showUserNotes = null;
    },
    handleLogout() {
      localStorage.removeItem('userId');
      localStorage.removeItem('userName');
      this.$router.push('/');
    },
    async showUserNoteList(){
      const userId = localStorage.getItem('userId');
      try {
            const response = await axios.post('/api/getUserNotes', {
            userId,
            folderId: 'null',
            });
            this.showUserNotes = response.data.notes;
            this.showUserNotes = this.showUserNotes.filter(note => {
              return !this.taskNotes.some(taskNote => taskNote.note === note._id);
            });
        } catch (error) {
            console.error('ÂèñÂæóÁ≠ÜË®òÂ§±Êïó:', error);
            alert('ÂèñÂæóÁ≠ÜË®òÂ§±Êïó');
        }
    },
    async deleteNoteLink(noteId){
      try {
            await axios.post('/api/deleteNoteLink', {
            itemId: this.currentItemId,
            noteId,
            });
            this.NoteContent(this.currentItemId);
            this.resetNoteContemt();
        } catch (error) {
            console.error('Âà™Èô§Â§±Êïó:', error);
            alert('Âà™Èô§Â§±Êïó');
        }
    },
    async fetchNote(noteId) {
      try {
        const response = await axios.post('/api/getNote', { noteId });
        const note = response.data.note[0];
        this.noteId = note._id;
        this.noteName = note.name;
        if(note.content){
          this.noteContent = marked.parse(note.content);
        }else{
          this.noteContent = marked.parse('');
        }
        this.$nextTick(() => {
          const codeBlocks = document.querySelectorAll('#markdown-output pre code');
          codeBlocks.forEach(block => {
            hljs.highlightElement(block);
          });
        this.closeModal();
        });
      } catch (error) {
        console.error('ÂèñÂæóÁ≠ÜË®òÂ§±ÊïóÔºö', error);
        alert('ÁÑ°Ê≥ïÂèñÂæóÁ≠ÜË®ò');
      }
    },
    resetNoteContemt(){
      this.noteContent = null;
      this.noteName = null;
      this.noteId = null;
    },
    editNote(){
      localStorage.setItem('noteId', this.noteId);
      console.log(`Navigating to note with ID: ${this.noteId}`);
      this.$router.push({ name: 'editor' });
    },
    showTaskListModal(item) {
      this.showingTaskListForId = item._id;
    },
    closeTaskModal() {
      this.showingTaskListForId = null;
    },
    async moveToTask(taskId){
      try {
          await axios.post('/api/moveItem', {
            itemId : this.showingTaskListForId,
            taskId,
          });
          await this.fetchUserTasks();
          this.handleTaskClick(taskId);
      } catch (error) {
          console.error('ÁßªÂãïÂ§±Êïó:', error);
          alert('Â§±Êïó');
      }
      this.closeTaskModal()
    },
  },
  async mounted() {
    localStorage.removeItem('TaskId');
    localStorage.removeItem('noteId');
    this.resetFilters();
    await this.fetchUserTasks();
  }
};
</script>

<style scoped>
/* Container */
.container {
  display: flex;
  height: 100vh;
  background-color: #e2e8f0; /* Light gray background */
  margin-left: 16px; /* Move content to the right */
}

/* Sidebar (1/4 width) */
.sidebar {
  width: 350px;
  background-color: #1f1f1f; /* Dark gray background */
  color: white;
  display: flex;
  flex-direction: column;
  padding: 16px;
  flex-shrink: 0;
  transition: width 0.3s ease;
}

.sidebar-header {
  padding: 16px;
  background-color: #121212; /* Darker gray */
  border-bottom: 1px solid #4a5568; /* Border between header and list */
}

.sidebar-title {
  font-size: 24px;
  font-weight: bold;
}


.input {
  border: 1px solid #e2e8f0;
  padding: 8px;
  border-radius: 8px;
  width: 100%;
}

.select {
  width: 33.33%;
}

/* Buttons */
.button {
  padding: 12px 24px;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
  transition: opacity 0.3s ease;
  width: 100%;
  background-color: white;
  color: #333;
  border: 2px solid #ccc;
}

.button:hover {
  opacity: 0.9;
  border-color: #777;
}

.button.white {
  background-color: white;
  color: #333;
}

.button.white:hover {
  background-color: #f7fafc; /* Light gray background */
}

.button.white:disabled {
  background-color: #b0b0b0;
  color: #999;
  cursor: not-allowed;
  border-color: #ccc;
}

/* Main Content (Right) */
.main-content {
  flex-grow: 1;
  padding: 16px;
  background-color: #2e2e2e;
  transition: all 0.3s;
}

.main-content h1 {
  color: white; /* Blue color */
}

.main-content ul li {
  margin-bottom: 8px;
}

.logout-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
}

.logout-button {
  padding: 8px 16px;
  background-color: #ff4444;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.logout-button:hover {
  background-color: #cc0000;
}

.task-title {
  border: none; /* Remove the border */
  padding: 15px 30px;
  text-align: center;
  font-size: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  background-color: transparent; /* Keep background transparent */
  color: white; /* Set text color to white */
  display: block; /* ËÆìÊØèÂÄãÊåâÈàïÈ°ØÁ§∫Âú®Êñ∞Ë°å */
  margin-bottom: 5px; /* ÂèØÈÅ∏ÔºåËÆìÊØèÂÄãÊåâÈàï‰πãÈñìÊúâÈñìË∑ù */
}

.task-title:hover {
  color: #45a049; /* Change text color on hover */
  transform: scale(1.1);
}

.task-title:active {
  color: #3e8e41; /* Change text color on click */
}

/* Task Table */
.task-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px;
  font-size: 18px; /* ÊîæÂ§ßÊï¥È´îÂ≠óÈ´î */
  text-align: center; /* ËÆìÊâÄÊúâÊñáÂ≠óÈÉΩÁΩÆ‰∏≠ */
  min-width: 1000px;
}

/* Table Header */
.task-table th {
  background-color: #2e2e2e;
  color: white; /* ÁôΩËâ≤Â≠óÈ´î */
  font-size: 20px; /* ÊîæÂ§ßË°®È†≠Â≠óÈ´î */
  text-align: center; /* Ë°®È†≠ÊñáÂ≠óÁΩÆ‰∏≠ */
  padding: 12px; /* Ë™øÊï¥Ë°®È†≠ÂÖßË∑ù */
  z-index: 1;
  position: sticky;
  top: 0;
  border-right: 1px solid #2e2e2e;
}

/* Styling for table rows */
.task-table tr {
  background-color: #333; /* ÊØèË°åÁöÑËÉåÊôØÈ°èËâ≤ËºÉÊ∑± */
  transition: background-color 0.3s ease; /* ÊªëÈº†Êá∏ÊµÆËÆäËâ≤ */
}

/* Hover effect for rows */
.task-table td:hover {
  background-color: #444; /* ÊªëÈº†Êá∏ÊµÆÊôÇËÆäËâ≤ */
}

/* Styling for table cells */
.task-table td {
  padding: 12px;
  color: white; /* ÁôΩËâ≤Â≠óÈ´î */
  background-color: #444; /* ÊØèÂÄãÊ¨Ñ‰ΩçÁöÑËÉåÊôØÈ°èËâ≤ */
  transition: background-color 0.3s ease; /* ÊªëÈº†Êá∏ÊµÆËÆäËâ≤ */
}

/* Hover effect for table cells */
.task-table td:hover {
  background-color: #555; /* ÊªëÈº†Êá∏ÊµÆÊôÇËÆäÊ∑∫Ëâ≤ */
}

/* Styling for input fields in table cells */
.task-table td input {
  width: 100%;
  padding: 10px;
  font-size: 18px; /* ÊîæÂ§ßÂ≠óÈ´î */
  background-color: transparent;
  color: white;
  border: none; /* ÁßªÈô§ÈÇäÊ°Ü */
  outline: none; /* ÁßªÈô§ÁÑ¶ÈªûÂ§ñÊ°Ü */
  text-align: center; /* Ëº∏ÂÖ•Ê°ÜÂÖßÊñáÂ≠óÁΩÆ‰∏≠ */
}

/* Styling for select dropdowns */
.task-table td select {
  width: 100%;
  padding: 10px;
  font-size: 18px; /* ÊîæÂ§ßÂ≠óÈ´î */
  background-color: transparent;
  color: white;
  border: none; /* ÁßªÈô§ÈÇäÊ°Ü */
  outline: none; /* ÁßªÈô§ÁÑ¶ÈªûÂ§ñÊ°Ü */
  text-align: center; /* ‰∏ãÊãâÈÅ∏ÂñÆÊñáÂ≠óÁΩÆ‰∏≠ */
}

/* Styling for select options */
.task-table td select option {
  background-color: #333; /* Ê∑±ÁÅ∞Ëâ≤ËÉåÊôØ */
  color: white; /* ÁôΩËâ≤Â≠óÈ´î */
  font-size: 18px; /* ÊîæÂ§ßÂ≠óÈ´î */
  text-align: center; /* ‰∏ãÊãâÈÅ∏ÂñÆÈÅ∏È†ÖÊñáÂ≠óÁΩÆ‰∏≠ */
}

/* Task title input field */
.task-title-input {
  background: transparent;
  border: none; /* ÁßªÈô§ÈÇäÊ°Ü */
  font-size: 36px; /* ÊîæÂ§ßÂ≠óÈ´î */
  font-weight: bold;
  color: white;
  width: 100%;
  outline: none; /* ÁßªÈô§ÁÑ¶ÈªûÂ§ñÊ°Ü */
}

.split-container {
  margin-top: 50px;
  display: flex;
  justify-content: space-between;
  width: 100%;
}

.task-container {
  padding: 10px;
}

.note-content-block {
  margin-top: 20px;
  padding: 10px;
}

.header-with-button {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.mode-toggle-button {
  background: none;
  border: none;
  color: #e2e8f0;
  font-size: 18px;            /* Â≠óÈ´îÂä†Â§ß */
  font-weight: 600;           /* Êõ¥Á≤ó‰∏Ä‰∫õËÆìÊñáÂ≠óÊõ¥ÊòéÈ°Ø */
  cursor: pointer;
  padding: 12px 20px;         /* ÂÖßË∑ùÂä†Â§ßÔºöÊï¥È´îÊîæÂ§ßÊÑü */
  transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease;
  border-radius: 6
}

.mode-toggle-button:hover {
  background-color: rgba(255, 255, 255, 0.15);
  color: #ffffff;
  transform: scale(1.05);     /* Êá∏ÊµÆÊôÇÂæÆÊîæÂ§ß */
}

.mode-toggle-button:active {
  transform: scale(0.98);
}

/* Styling for the delete button */
.delete-button {
  background-color: #ff4444;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 8px 16px;
  cursor: pointer;
  font-size: 18px;
  transition: background-color 0.3s ease;
}

.delete-button:hover {
  background-color: #cc0000;
}

.delete-button:focus {
  outline: none;
}

.task-header {
  display: flex;
  justify-content: space-between; /* ËÆìÂÖßÂÆπÂÖ©Á´ØÂ∞çÈΩä */
  align-items: center; /* ËÆìÂÖßÂÆπÂûÇÁõ¥Â±Ö‰∏≠ */
  width: 100%;
}

/* Container for input and button */
.header-with-button {
  display: flex;
  align-items: center;         /* ÂûÇÁõ¥Â±Ö‰∏≠ */
  justify-content: space-between; /* ËÆìinputÂíåbuttonÂÖ©Á´ØÂ∞çÈΩä */
  width: 100%;
  margin-bottom: 16px; /* ÁÇ∫‰∫ÜËÆìË°®Ê†ºËàáËº∏ÂÖ•Ê°Ü‰πãÈñìÊúâ‰∏ÄÈªûË∑ùÈõ¢ */
}

/* Styling for the delete button */
.delete-button {
  background-color: #333; /* Ê∑±ÁÅ∞Ëâ≤ËÉåÊôØ */
  color: white;
  border: none; /* ÂéªÊéâÈÇäÊ°Ü */
  border-radius: 8px;
  padding: 8px 16px;
  cursor: pointer;
  font-size: 14px; /* Á∏ÆÂ∞èÂ≠óÈ´î */
  transition: background-color 0.3s ease;
}

.delete-button:hover {
  background-color: #555; /* Êá∏ÊµÆÊôÇËÆäÁÇ∫Á®çÂæÆÊ∑∫‰∏ÄÈªûÁöÑÁÅ∞Ëâ≤ */
}

.delete-button:focus {
  outline: none;
}


/* Task title input field */
.task-title-input {
  background: transparent;
  border: none;
  font-size: 36px;  /* ÊîæÂ§ßÂ≠óÈ´î */
  font-weight: bold;
  color: white;
  width: 100%;      /* ‰øùÊåÅÂØ¨Â∫¶100% */
  outline: none;
  margin-right: 10px; /* ÊåâÈàïËàáËº∏ÂÖ•Ê°Ü‰πãÈñìÁöÑÈñìÈöî */
}

/* Add scrollable container for the table */
.scrollable-table-container {
  max-height: 400px;  /* ÈôêÂà∂ÊúÄÂ§ßÈ´òÂ∫¶ÔºåÁï∂ÂÖßÂÆπË∂ÖÈÅéÈÄôÂÄãÈ´òÂ∫¶ÊôÇÈ°ØÁ§∫ÊªæÂãïÊ¢ù */
  overflow-y: auto;   /* ÂûÇÁõ¥ÊªæÂãï */
  margin-top: 16px;    /* Ë™øÊï¥ÈñìË∑ù */
  overflow-x: auto;
  width: 100%;
}

.task-list {
  max-height: 550px; /* Ê†πÊìö‰Ω†È†ÅÈù¢ÈúÄÊ±ÇË™øÊï¥È´òÂ∫¶ */
  overflow-y: auto;  /* ÂïüÁî®ÂûÇÁõ¥Êç≤Âãï */
  gap: 8px; /* ÊØèÂÄã‰ªªÂãôÊåâÈàïÁöÑÈñìË∑ùÔºåÂèØËá™Ë®Ç */
}

/* È°ØÁ§∫ÂûÉÂúæÊ°∂ÊåâÈàïÊ¨Ñ‰ΩÜÈ†êË®≠Èö±Ëóè */
.delete-cell {
  width: 40px;
  text-align: center;
}

.delete-icon {
  background: transparent;
  border: none;
  color: white;
  font-size: 18px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.3s ease;
}

/* ÊªëÈº†ÁßªÂà∞Ë©≤ÂàóÊôÇÔºåÈ°ØÁ§∫ÂûÉÂúæÊ°∂ */
.task-row:hover .delete-icon {
  opacity: 1;
}

/* ÁØ©ÈÅ∏ÊåâÈàïÊ®£Âºè */
.filter-bar {
  display: flex;
  gap: 12px;
  margin: 16px 0;
}

.filter-button {
  padding: 8px 16px;
  background-color: #444;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.filter-button.active {
  background-color: #222;
}

/* Modal Ë¶ÜËìãÂ±§Ê®£Âºè */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
  animation: fadeIn 0.3s ease-out;
}

.modal-content {
  background-color: #333;
  padding: 20px;
  border-radius: 12px;
  color: white;
  width: 300px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  animation: slideUp 0.3s ease-out;
}

/* Modal Title */
.modal-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 15px;
  text-align: center;
}

/* Modal Input */
.modal-input {
  width: 100%;
  padding: 8px;
  font-size: 16px;
  margin-bottom: 15px;
  background-color: #444;
  color: white;
  border: none;
  border-radius: 8px;
}

.modal-buttons {
  display: flex;
  justify-content: space-between;
  gap: 10px;
}

/* Cancel & Confirm Buttons */
.modal-cancel, .modal-confirm {
  padding: 8px 16px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.modal-cancel {
  background-color: #777;
  color: white;
}

.modal-confirm {
  background-color: #2e7d32;
  color: white;
}

.modal-cancel:hover {
  background-color: #666;
}

.modal-confirm:hover {
  background-color: #1b5e20;
}

/* ÁãÄÊÖãÈÅ∏È†ÖÊ®£Âºè */
.status-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* ÂãïÁï´ÊïàÊûú */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.filter-label {
  margin-right: 10px;
  font-size: 20px;
  font-weight: bold;
  color: white;
}

.triangle {
  display: inline-block;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  margin-left: 5px; /* ÂêëÂè≥ÂÅèÁßª */
}

.up {
  border-bottom: 10px solid white; /* ‰∏ä‰∏âËßíÂΩ¢È°èËâ≤ÁÇ∫ÁôΩËâ≤ */
}

.down {
  border-top: 10px solid white; /* ‰∏ã‰∏âËßíÂΩ¢È°èËâ≤ÁÇ∫ÁôΩËâ≤ */
}

.content-icon {
  background-color: transparent;
  border: none;
  cursor: pointer;
  font-size: 24px; /* Adjust the size as needed */
}

.content-icon:hover {
  opacity: 0.8; /* Optional: Add a hover effect */
}

/* Overlay for the modal */
#editModal {
  display: flex; /* Default to flex so it can be shown/hidden with opacity */
  position: fixed; /* Stays fixed at the top of the page */
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(30, 30, 30, 0.8); /* Dark gray background with transparency */
  justify-content: center;
  align-items: center;
  z-index: 1000; /* Ensure it‚Äôs above other content */
  transition: opacity 0.3s ease-in-out;
  opacity: 0; /* Hidden by default */
}

/* Modal content box */
.edit-modal-content {
  background-color: #333; /* Dark gray background */
  color: #fff; /* White text */
  padding: 60px; /* Increase padding to make the content area larger */
  border-radius: 10px; /* Rounded corners */
  max-width: 800px; /* Increase max width to allow for a wider modal */
  width: 100%; /* Full width responsive */
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.3); /* Slight shadow for depth */
  display: flex;
  flex-direction: column;
  gap: 30px; /* Space between the elements inside the modal */
}

/* Textarea styling */
textarea {
  background-color: #444; /* Dark gray background */
  color: #fff; /* White text */
  padding: 16px; /* Larger padding for the textarea */
  font-size: 20px; /* Increase font size for better readability */
  border: 2px solid #555; /* Darker border */
  border-radius: 8px; /* Rounded corners for the input */
  width: 100%; /* Full width */
  min-height: 200px; /* Make the textarea taller */
  resize: none; /* Disable resizing */
  box-sizing: border-box; /* Ensure padding and border are included in the width */
}

/* When the modal is open, change opacity and display */
#editModal.open {
  opacity: 1; /* Fully visible when open */
}

/* Optional: Close modal when clicking outside */
#editModal.open {
  cursor: pointer;
}

#editModal.open .modal-content {
  cursor: auto;
}

/* Styling for the Save button */
.modal-save-button {
  background-color: #4CAF50; /* Green background */
  color: white; /* White text */
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.modal-save-button:hover {
  background-color: #45a049; /* Darker green on hover */
}

/* Styling for the Cancel button */
.modal-cancel-button {
  background-color: #f44336; /* Á¥ÖËâ≤ËÉåÊôØ */
  color: white;              /* ÁôΩËâ≤ÊñáÂ≠ó */
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.modal-cancel-button:hover {
  background-color: #e53935; /* Darker red on hover */
}

.note-modal{
  background-color: #444;
  color: #222;
  padding: 30px 40px;
  border-radius: 12px;
  min-width: 400px;
  min-height: 600px;
  max-width: 90vw;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
  font-size: 1.1rem;
  transform: scale(1.05);
  transition: all 0.3s ease;

  display: flex;
  flex-direction: column;
  justify-content: space-between; /* ËÆìÂÖßÂÆπÂæÄ‰∏ä„ÄÅÊåâÈàïÂæÄ‰∏ã */
}

.modal-body {
  flex-grow: 1; /* ËÆìÂÖßÂÆπÂçÄÂüüÂ°´Êªø‰∏äÊñπÁ©∫Èñì */
  max-height: 450px;  /* Ë®≠ÂÆöÊúÄÂ§ßÈ´òÂ∫¶ÔºåÊ†πÊìöÈúÄË¶ÅË™øÊï¥ */
  overflow-y: auto;   /* ÂÖÅË®±ÂûÇÁõ¥ÊªæÂãï */
  padding-right: 10px;
}

.add-note-button {
  background: none;         /* ÁÑ°ËÉåÊôØ */
  border: none;             /* ÁÑ°ÈÇäÊ°Ü */
  color: white;             /* ÁôΩËâ≤ÊñáÂ≠ó */
  font-size: 16px;          /* ‰Ω†ÂèØ‰ª•‰æùÈúÄÊ±ÇË™øÊï¥Â≠óÈ´îÂ§ßÂ∞è */
  cursor: pointer;          /* ÊªëÈº†ÁßªÈÅéÂéªËÆäÊåáÊ®ô */
  transition: transform 0.2s ease, color 0.2s ease;
}

.add-note-button:hover {
  transform: scale(1.2);    /* Êá∏ÊµÆÊîæÂ§ß */
  color: #4caf50;           /* ÂèØÈÅ∏ÔºöÊá∏ÊµÆÊôÇËÆäÈªÉËâ≤ÊàñÂÖ∂‰ªñËâ≤ */
}

.note-button {
  background: none;             /* ÁÑ°ËÉåÊôØ */
  border: none;                 /* ÁÑ°ÈÇäÊ°Ü */
  color: white;                 /* ÁôΩËâ≤ÊñáÂ≠ó */
  padding: 10px 20px;           /* Ë™øÊï¥ÂÖßÈÇäË∑ù */
  cursor: pointer;              /* ÊªëÈº†ÁßªÂãïÂà∞ÊåâÈàï‰∏äÊôÇËÆäÊàêÊåáÊ®ô */
  transition: transform 0.2s ease, color 0.2s ease; /* ÊñáÂ≠óÈ°èËâ≤ÈÅéÊ∏°ÊïàÊûú */
  font-size: 20px; 
}

.note-button:hover {
  color: #4CAF50;               /* Êá∏ÊµÆÊôÇÊîπËÆäÊñáÂ≠óÈ°èËâ≤ÁÇ∫Á∂†Ëâ≤ */
  transform: scale(1.1);         /* Êá∏ÊµÆÊôÇÊîæÂ§ß */
}

.linkable-notes-title {
  color: white;            /* ÁôΩËâ≤ÊñáÂ≠ó */
  font-size: 35px;         /* ÂèØ‰ª•Ë™øÊï¥Â≠óÈ´îÂ§ßÂ∞è */
  font-weight: 600;        /* Â≠óÈ´îÂä†Á≤ó */
  margin-bottom: 10px;     /* Â∫ïÈÉ®ÁïôÈªûÁ©∫Èñì */
  opacity: 0.8;            /* ÈÅ©Áï∂ÈÄèÊòéÂ∫¶ÔºåÂ¢ûÂä†ÊüîÂíåÊÑü */
}

.note-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
}

.edit-note-btn {
  background-color: #333; /* Ê∑±ÁÅ∞Â∫ï */
  color: #fff; /* ÁôΩÂ≠ó */
  border: none; /* ÂèØÈÅ∏ÔºöÁßªÈô§ÈÇäÊ°Ü */
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s;
}

.edit-note-btn:hover {
  background-color: #555; /* ÊªëÈº†Êá∏ÂÅúÊôÇËÆäÊõ¥È°èËâ≤ */
}

.close-note-btn {
  background-color: #444;  /* Ê∑±ÁÅ∞ËÉåÊôØ */
  color: #000;             /* ÈªëËâ≤ÂèâÂèâ */
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  position: absolute; /* Âõ∫ÂÆöÊåâÈàïÂú®Âè≥‰∏äËßí */
  top: 0;
  right: 0;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s;
  margin-top: 80px;
  margin-right: 30px;
}

.close-note-btn:hover {
  background-color: #333;  /* Êõ¥Ê∑±ÁöÑÁÅ∞Ëâ≤ËÉåÊôØ on hover */
}

#markdown-output {
  max-height: 400px;  /* Ë®≠ÂÆöÊúÄÂ§ßÈ´òÂ∫¶ÔºåÊ†πÊìöÈúÄË¶ÅË™øÊï¥ */
  overflow-y: auto;   /* ÂÖÅË®±ÂûÇÁõ¥ÊªæÂãï */
}

.collapse-button,
.expand-button {
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  margin-bottom: 10px;
  color: white; /* Ë®≠ÂÆöÊñáÂ≠óÈ°èËâ≤ÁÇ∫ÁôΩËâ≤ */
}

/* mini-sidebar ËÆæÁΩÆ‰∏∫ flex ÂÆπÂô® */
.mini-sidebar {
  background-color: #1f1f1f;
  display: flex; /* ‰ΩøÁî® flexbox Â∏ÉÂ±Ä */
  justify-content: center; /* Ê∞¥Âπ≥Â±Ö‰∏≠ */
  align-items: center; /* ÂûÇÁõ¥Â±Ö‰∏≠ */
  height: 100vh; /* ‰Ωø sidebar Â°´Êª°Êï¥‰∏™ËßÜÂè£È´òÂ∫¶ */
}

.move-icon {
  color: white;
  background: transparent;
  border: none;
  font-size: 1.25rem; /* Á¥ÑÁ≠âÊñº Tailwind ÁöÑ text-xl */
  padding: 0;
}
</style>